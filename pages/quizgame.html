<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Juego de Preguntas âœ¨</title>
    
    <link rel="stylesheet" href="../assets/scss/main.css">
</head>
<body class="quiz-page">

    <div id="intro-overlay" class="overlay" style="display: block;"></div>
    <div id="intro-modal" class="modal" style="display: block;">
        <img src="../assets/images/snoopy_pensando.png" alt="Snoopy Pensando" class="snoopy-thinking">
        <h2>Este es el DesafÃ­o Diario âœ¨</h2>
        <p>Â¿QuÃ© tan bien nos conocÃ©s? <br><br> â€¢ 5 preguntas nuevas cada dÃ­a.<br> â€¢ Si fallas una, volvÃ©s maÃ±ana.<br> â€¢ RespondÃ© todas bien y llevate un cÃ³digo.</p>
        <button class="btn" onclick="startGame()">EMPEZAR AHORA</button>
    </div>

    <div class="quiz-card">
        <div class="timer-container" id="timer">30s</div>
        <div class="progress-dots" id="dots"><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
        <div class="question-text" id="q-text">Cargando...</div>
        <div class="options-grid" id="options"></div>
    </div>

    <div class="overlay" id="overlay"></div>
    <div id="status-modal" class="modal">
        <h2 id="modal-title"></h2>
        <p id="modal-msg"></p>
        <div id="codigo-box" style="display:none; font-size: 1.5rem; font-weight: bold; color: #fb6f92; margin: 15px 0; background: #fff0f5; padding: 10px; border-radius: 10px;"></div>
        <button class="btn" onclick="location.href='../index.html'">Volver</button>
    </div>

    <nav class="navbar">
        <div class="dropdown">
            <button onclick="toggleMenu(event)" class="dropbtn">â˜° MenÃº</button>
            <div id="myDropdown" class="dropdown-content">
                <a href="../index.html">ğŸ  Inicio</a>
                <a href="jump.html">ğŸƒ Snoopy Jump</a>
                <a href="memorygame.html">ğŸ§© Memoria</a>
                <a href="cooking_v2.html">ğŸ‘¨â€ğŸ³ Food Truck</a>
                <a href="djsnoopy.html">ğŸµ Dj Snoopy</a>
                <a href="codigos.html">ğŸ† Mis CÃ³digos</a>
                <a onclick="rewardAttemptAdmin()">ğŸ Recompensar Intento (Admin)</a>
                <a onclick="resetQuestionsAdmin()">ğŸ§¹ Reset Preguntas (Admin)</a>
                <a onclick="resetDailyAdmin()">ğŸ”“ Reset Diario (Admin)</a>
            </div>
        </div>
    </nav>

    <script src="../assets/js/main.js"></script>
    <script>
        // --- MOTOR DEL JUEGO (LÃ³gica exclusiva) ---
        const POOL_PREGUNTAS = [
            { id: 1, q: "Â¿CuÃ¡l es mi color favorito?", o: ["Azul", "Negro", "Verde", "Rojo"], a: 3 },
            { id: 2, q: "Â¿En quÃ© ciudad nacÃ­?", o: ["Barranqueras", "Resistencia", "Corrientes", "Fontana"], a: 1 },
            { id: 3, q: "Â¿CuÃ¡l es mi perfume favorito de mi colecciÃ³n?", o: ["Banderas KOF", "Bad Boy CH", "Bensimon Brave"], a: 1 },
            { id: 4, q: "Â¿CuÃ¡l es mi videojuego favorito de toda la vida?", o: ["Silent Hill 2", "Resident Evil 4", "Half-Life 2", "Asassins Creed 3"], a: 2 },
            { id: 5, q: "Â¿Mi nombre en videojuegos es...?", o: ["Ivanov", "Tuki", "DarkCrow", "Sokolov"], a: 3 },
            { id: 6, q: "Â¿QuÃ© prefiero comer?", o: ["Milanesas", "Hamburguesas", "Pizza", "Torta Parrilla"], a: 2 },
            { id: 7, q: "Â¿CuÃ¡l carrera nunca estudiÃ©?", o: ["ProgramaciÃ³n", "PsciologÃ­a", "Contador", "InformÃ¡tica"], a: 3 },
            { id: 8, q: "Â¿QuÃ© pelÃ­cula NO vimos juntos?", o: ["7 MagnÃ­ficos", "Harta", "Thunderbolts", "Recuerdame"], a: 3 },
            { id: 9, q: "Â¿Primera serie que vimos?", o: ["La de la Prision", "Nadie quiere esto", "Ozarks", "Brooklyn 99"], a: 1 },
            { id: 10, q: "Â¿Sabor de helado favorito?", o: ["Dulce de Leche", "Granizado", "Rocher", "Bananasplit"], a: 0 },
            { id: 11, q: "Â¿Color de pelo que NUNCA tuve?", o: ["Celeste", "Rojo", "Blanco", "Verde"], a: 3 },
            { id: 12, q: "Â¿Nombre de mi Abuela?", o: ["Bettina", "Roberta", "Roxana", "Daniela"], a: 1 },
            { id: 13, q: "Â¿CuÃ¡l NO fue un trabajo mÃ­o?", o: ["Bombero", "Mozo", "Quinielero", "Creador de Contenido"], a: 2},
            { id: 14, q: "Â¿Consola favorita?", o: ["PS3", "PS2", "Xbox 360", "PS1"], a: 1 },
            { id: 15, q: "Â¿Primer lugar donde cenamos?", o: ["Shopping", "Foodie", "La Usina", "La Pettit"], a: 1 },
            { id: 16, q: "Â¿Alfajor favorito?", o: ["Ãguila Brownie", "Rasta Negro", "Terrabusi", "Chocotorta"], a: 0 },
            { id: 17, q: "Â¿Cuantas cosas (materiales) te regalÃ© en tu cumple aÃ±os?", o: ["Tres", "Cuatro", "Dos", "Cinco"], a: 0 },
            { id: 18, q: "Â¿QuÃ© comimos la 1ra vez que viniste a casa?", o: ["Chipa/Pizza", "Hamburguesa", "Chipa/Burger", "Solo Burger"], a: 2 },
            { id: 19, q: "Â¿Deporte que NUNCA entrenÃ©?", o: ["Futbol", "Voley", "Basquet", "NataciÃ³n"], a: 3 },
            { id: 20, q: "Â¿PelÃ­cula animada favorita?", o: ["Tarzan", "UP", "Planeta Tesoro", "Wall-E"], a: 2 },
            { id: 21, q: "Â¿SuperhÃ©roe favorito tras Spidey?", o: ["Daredevil", "Superman", "Star-Lord", "Thor"], a: 0},
            { id: 22, q: "Â¿Artista favorito?", o: ["Manson", "Cerati", "Tan Bionica", "Avril"], a: 2 },
            { id: 23, q: "Â¿QuÃ© tanto me amas?", o: ["Mucho", "MuchÃ­simo", "Tanto que te compro una Play 5", "Algo"], a: 2 },
            { id: 24, q: "Si un hombre te habla...", o: ["Le contesto", "Le Disparo", "Aviso a IvÃ¡n", "Ignoro"], a: 1 },
            { id: 25, q: "Â¿CuÃ¡l de estos Artistas NO soporto su mÃºsica?", o: ["Bad Bunny", "Maria Becerra", "La Joaqui", "Milo J"], a: 2 },
            { id: 26, q: "Â¿CuÃ¡l de estas cosas guardo sin contexto en el cajon de mi mesita de luz?", o: ["Un Silbato", "Una Lija", "Una Toallita Femenina", "Todas"], a: 3 },
            { id: 27, q: "Â¿Cuantos Meses pasaron desde que hablamos hasta ser Novios?", o: ["5", "3", "6", "4"], a: 0},
            { id: 28, q: "Â¿De cuÃ¡l de estos superhÃ©roes no tengo juguete o peluche?", o: ["Capitana Marvel", "Batman", "Spider-Man", "Superman"], a: 3 },
            { id: 29, q: "Â¿En quÃ© brazo tengo una cicatriz?", o: ["Izquierdo", "Derecho", "Ninguno"], a: 1 },
            { id: 30, q: "Â¿De quÃ© marca es el auto de mi papÃ¡?", o: ["Peugeot", "Chevrolet", "Volkwswagen", "Toyota"], a: 3 },
            { id: 31, q: "Â¿De quÃ© marca es mi Notebook?", o: ["HP", "Acer", "Lenovo", "Exo"], a: 2 },
            { id: 32, q: "Â¿De cuales de estos equipos de Futbol NO tengo una camiseta?", o: ["AC Milan", "Barcelona", "River", "Argentina"], a: 1 },
            { id: 33, q: "Cuantos ambientes tiene mi casa de adelante SIN contar cocina, pasillos, y la construcciÃ³n?", o: ["4", "3", "6", "7"], a: 2 },
            { id: 34, q: "Â¿CuÃ¡l es la verdura mÃ¡gica que trajo un hada a tu casa?", o: ["MorrÃ³n", "Lechuga", "Tomate", "Cebolla"], a: 3 },
            { id: 35, q: "Â¿CuÃ¡l de estos es mi DNI?", o: ["43616523", "43666199", "41252599", "44243376"], a: 0},
            { id: 36, q: "Â¿En cuÃ¡les de estos lugares de yo NUNCA comprÃ© ropa?", o: ["Narrow", "Le Utte", "MacOwens", "Goodfla"], a: 3 },
            { id: 37, q: "Â¿Cual es mi pizzerÃ­a favorita de Resistencia?", o: ["Pizza Pietra", "Los Campeones", "Pizza Pueblo", "La Isla"], a: 1 },
            { id: 38, q: "Â¿CuÃ¡l fue el primer familiar tuyo que conocÃ­ formalmente?", o: ["Abuela", "TÃ­a Laura", "TÃ­a Mari", "Hermana"], a: 3 },
            { id: 37, q: "Â¿Con quÃ© me intoxiquÃ© cuando era chico?", o: ["Pizza", "Chocolates", "Helado", "Bife"], a: 1 },
            { id: 38, q: "Â¿A cuÃ¡l de estos lugares NUNCA viajÃ©?", o: ["Brasil", "Misiones", "Salta", "Paraguay"], a: 3 }
        ];
        const CODIGOS_MAESTROS = ["culogordo", "ternerito", "05052025", "bebota", "elefante", "cocodrilo", "mariquita", "01022025", "24032025", "woodstuck", "sanvalentin", "papasfritas", "peonias", "hombrearaÃ±a", "patatuilla", "silenciogil", "chipamboca", "colorincolorao", "gatitoexplota", "pinguinoenojado", "uncodigorandom", "uncodigorandom2", "equisde", "esnupi", "ca1000", "hayquematarlo"];
        let dailySet = [], currentIndex = 0, timer, timeLeft = 30;

        function initQuiz() {
            const hoyArgentina = new Date().toLocaleDateString("es-AR", {timeZone: "America/Argentina/Buenos_Aires"});
            const lastDate = localStorage.getItem('quizLastDate');
            if (lastDate !== hoyArgentina) {
                localStorage.removeItem('quizState'); localStorage.removeItem('quizDailySet');
                localStorage.removeItem('quizCurrentIndex'); localStorage.setItem('quizLastDate', hoyArgentina);
            }
            const state = localStorage.getItem('quizState');
            if (state === 'won' || state === 'failed' || state === 'in_progress') {
                document.getElementById('intro-modal').style.display = 'none'; document.getElementById('intro-overlay').style.display = 'none';
                if(state === 'won') showModal("Ya sacaste tu cÃ³digo diario ğŸŒŸ", "VolvÃ© maÃ±ana.");
                else if(state === 'in_progress') failGame("Abandonaste el desafÃ­o...");
                else showModal("DÃ­a bloqueado âŒ", "IntentÃ¡ de nuevo maÃ±ana.");
            }
        }

        function startGame() {
            localStorage.setItem('quizState', 'in_progress');
            const hist = JSON.parse(localStorage.getItem('quizCorrectasHistoricas')) || [];
            const pool = POOL_PREGUNTAS.filter(p => !hist.includes(p.id));
            if (pool.length < 5) { showModal("Â¡Genia! ğŸ“", "Respondiste casi todo."); return; }
            document.getElementById('intro-modal').style.display = 'none'; document.getElementById('intro-overlay').style.display = 'none';
            const saved = localStorage.getItem('quizDailySet');
            if (saved) { dailySet = JSON.parse(saved); currentIndex = parseInt(localStorage.getItem('quizCurrentIndex')) || 0; }
            else { dailySet = pool.sort(() => 0.5 - Math.random()).slice(0, 5); localStorage.setItem('quizDailySet', JSON.stringify(dailySet)); currentIndex = 0; }
            renderQuestion();
        }

        function startTimer() {
            clearInterval(timer); timeLeft = 30; document.getElementById('timer').innerText = "30s";
            timer = setInterval(() => { timeLeft--; document.getElementById('timer').innerText = timeLeft + "s"; if (timeLeft <= 0) failGame("Â¡Tiempo agotado! â°"); }, 1000);
        }

        function renderQuestion() {
            startTimer(); const q = dailySet[currentIndex]; document.getElementById('q-text').innerText = q.q;
            const optDiv = document.getElementById('options'); optDiv.innerHTML = "";
            q.o.forEach((opt, i) => { const btn = document.createElement('button'); btn.className = 'option-btn'; btn.innerText = opt; btn.onclick = () => checkAnswer(i); optDiv.appendChild(btn); });
            const dots = document.querySelectorAll('.dot'); dots.forEach((d, i) => d.className = i < currentIndex ? 'dot active' : 'dot');
        }

        function checkAnswer(idx) {
            clearInterval(timer);
            if (idx === dailySet[currentIndex].a) {
                let hist = JSON.parse(localStorage.getItem('quizCorrectasHistoricas')) || [];
                if(!hist.includes(dailySet[currentIndex].id)) hist.push(dailySet[currentIndex].id);
                localStorage.setItem('quizCorrectasHistoricas', JSON.stringify(hist));
                currentIndex++; localStorage.setItem('quizCurrentIndex', currentIndex);
                if (currentIndex === 5) winGame(); else renderQuestion();
            } else { failGame("Respuesta incorrecta ğŸ’”"); }
        }

        function winGame() {
            localStorage.setItem('quizState', 'won');
            let cons = JSON.parse(localStorage.getItem('codigosConseguidos')) || [];
            let disp = CODIGOS_MAESTROS.filter(c => !cons.includes(c));
            let premio = disp.length > 0 ? disp[Math.floor(Math.random()*disp.length)] : "CAMPEONA";
            if(disp.length > 0) { cons.push(premio); localStorage.setItem('codigosConseguidos', JSON.stringify(cons)); }
            document.getElementById('codigo-box').innerText = premio.toUpperCase(); document.getElementById('codigo-box').style.display = 'block';
            showModal("Â¡PERFECTO! ğŸ†", "Ganaste el cÃ³digo:");
        }

        function failGame(msg) { clearInterval(timer); localStorage.setItem('quizState', 'failed'); showModal("Muerte SÃºbita ğŸ’”", msg); }
        function showModal(title, msg) { document.getElementById('modal-title').innerText = title; document.getElementById('modal-msg').innerText = msg; document.getElementById('overlay').style.display = 'block'; document.getElementById('status-modal').style.display = 'block'; }
        
        initQuiz();
    </script>
</body>
</html>