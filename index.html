<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Aether Love Notes ‚ú®</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&display=swap');
        :root { --rosa-fuerte: #fb6f92; --rosa-medio: #ff8fab; --rosa-claro: #ffc8dd; --rosa-fondo: #fff0f5; --texto: #8a5a6a; }
        body { background-color: var(--rosa-fondo); font-family: 'Quicksand', sans-serif; display: flex; align-items: center; justify-content: center; min-height: 100vh; margin: 0; padding: 15px; box-sizing: border-box; background-image: radial-gradient(var(--rosa-claro) 0.8px, transparent 0.8px); background-size: 24px 24px; }
        .navbar { position: fixed; top: 0; width: 100%; display: flex; justify-content: flex-end; padding: 15px; box-sizing: border-box; z-index: 1000; }
        .dropbtn { background-color: white; color: var(--rosa-fuerte); padding: 10px 20px; font-size: 1rem; font-weight: bold; border: 2px solid var(--rosa-claro); border-radius: 25px; cursor: pointer; box-shadow: 0 4px 10px rgba(251,111,146,0.1); }
        .dropdown-content { display: none; position: absolute; right: 15px; top: 60px; background-color: white; min-width: 200px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); border-radius: 20px; border: 2px solid var(--rosa-claro); overflow: hidden; }
        .dropdown-content a { color: var(--texto); padding: 12px 16px; text-decoration: none; display: block; font-weight: 600; font-size: 0.9rem; cursor: pointer; }
        .dropdown-content a:hover { background-color: var(--rosa-fondo); }
        .show { display: block; }
        .main-card { background: white; padding: 35px 25px; border-radius: 45px; box-shadow: 0 20px 50px rgba(251, 111, 146, 0.2); text-align: center; border: 6px solid white; outline: 3px solid var(--rosa-claro); width: 100%; max-width: 420px; position: relative; }
        .snoopy-header { width: 180px; height: auto; margin-bottom: 10px; }
        h1 { color: var(--rosa-fuerte); font-size: 1.5rem; margin-bottom: 25px; }
        input { padding: 15px; border: 3px solid var(--rosa-fondo); background-color: var(--rosa-fondo); border-radius: 20px; width: 85%; margin-bottom: 20px; outline: none; text-align: center; font-size: 1.1rem; color: var(--texto); font-family: inherit; }
        .btn-validar { background: linear-gradient(135deg, var(--rosa-medio), var(--rosa-fuerte)); color: white; border: none; padding: 14px 40px; border-radius: 50px; font-weight: bold; cursor: pointer; width: 85%; }
        #gift-area { display: none; margin-top: 30px; }
        .envelope { background: var(--rosa-fuerte); padding: 25px; border-radius: 25px; color: white; font-size: 3rem; cursor: pointer; display: inline-block; animation: float 3s infinite ease-in-out; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        #couponCanvas { width: 100%; border-radius: 15px; margin-top: 20px; display: none; }
        .action-btn { display: none; margin-top: 15px; padding: 12px 25px; border-radius: 50px; text-decoration: none; font-weight: bold; width: 80%; cursor: pointer; font-family: inherit; }
        .btn-restart { background-color: var(--rosa-fuerte); color: white; border: none; }
        .download-link { color: var(--rosa-fuerte); border: 2px solid var(--rosa-fuerte); background: white; }
        .status-msg { font-size: 0.85rem; margin-top: 20px; color: var(--texto); font-style: italic; }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="dropdown">
            <button onclick="toggleMenu()" class="dropbtn">‚ò∞ Men√∫</button>
            <div id="myDropdown" class="dropdown-content">
                <a href="pages/jump.html">üèÉ Snoopy Jump</a>
                <a href="pages/memorygame.html">üß© Memoria</a>
                <a href="pages/quizgame.html">üß† Preguntados</a>
                <a href="pages/djsnoopy.html">üéµ Dj Snoopy</a>
                <a href="pages/codigos.html">üèÜ Mis C√≥digos</a>
                <a onclick="resetApp()">üßπ Reset Total (Admin)</a>
            </div>
        </div>
    </nav>

    <div class="main-card">
        <img src="assets/images/snoopy.jpg" alt="Snoopy" class="snoopy-header">
        <h1>Hola, mi amor ‚ú®</h1>
        <input type="text" id="pass" placeholder="Ingres√° un c√≥digo secreto">
        <br>
        <button class="btn-validar" id="btn-val" onclick="reveal()">Validar C√≥digo üíñ</button>
        <p id="counter" class="status-msg"></p>
        <div id="gift-area">
            <div class="envelope" id="env" onclick="generateTicket()">üíå</div>
            <canvas id="couponCanvas"></canvas>
            <center>
                <a id="downloadLink" class="action-btn download-link">‚¨áÔ∏è Guardar Cup√≥n</a>
                <button id="btn-restart" class="action-btn btn-restart" onclick="resetUI()">Canjear otro ‚ú®</button>
            </center>
        </div>
    </div>

    <script>
        const CLAVE_ADMIN = "ivancito";
        const CODIGOS = ["culogordo", "ternerito", "05052025", "bebota", "elefante", "cocodrilo", "mariquita", "01022025", "24032025", "woodstuck", "sanvalentin", "papasfritas", "peonias", "hombreara√±a", "patatuilla", "silenciogil", "chipamboca", "colorincolorao", "gatitoexplota", "pinguinoenojado", "uncodigorandom", "uncodigorandom2", "equisde", "esnupi", "ca1000", "hayquematarlo"]; 
        const VALES = ["UNA COMIDA A ELECCI√ìN", "UN REZO üôè", "UNA HORA DE MIMOS", "PASAR UN D√çA DONDE QUIERAS", "ALGO DULCE", "DORMIR UNA SIESTA", "JIJIS", "UNA COCUCHA O UN JUGO", "NO DECIRTE QUE NO (12 HS)", "REUTILIZAR UN CUP√ìN USADO", "UNAS MILANGAS NAPOLITANAS DE POLLO", "UNA PIZZA CASERA", "ELEGIR UNA PEL√çCULA", "UNA CARTITA", "UN REGALO", "$4000", "UN ASADO", "UN D√çA EN LA PLAYA O EN LA PILETA", "GALLETITAS BLOCK", "UNA HAMBURGUESA", "HELADO", "IR A FOODIE", "CUMPLIR UN DESEO", "FLORES O PELUCHE" ];

        let usados = JSON.parse(localStorage.getItem('cuponesUsados')) || [];
        let canjeados = JSON.parse(localStorage.getItem('codigosCanjeados')) || [];
        let codigoActual = "";

        function toggleMenu() { document.getElementById("myDropdown").classList.toggle("show"); }
        window.onclick = e => { if (!e.target.matches('.dropbtn')) document.getElementById("myDropdown").classList.remove('show'); }
        function resetApp() { if(prompt("Clave admin:") === CLAVE_ADMIN) { localStorage.clear(); location.reload(); } }
        function actualizarEstado() {
            const restantes = VALES.length - usados.length;
            document.getElementById('counter').textContent = restantes === 0 ? "Todo canjeado ‚ù§Ô∏è" : `Quedan ${restantes} cupones.`;
        }
        actualizarEstado();

        function reveal() {
            const input = document.getElementById('pass').value.toLowerCase().trim();
            if (!CODIGOS.includes(input)) { alert("C√≥digo inv√°lido"); return; }
            if (canjeados.includes(input)) { alert("Ya usado"); return; }
            codigoActual = input;
            document.getElementById('gift-area').style.display = 'block';
            document.getElementById('btn-val').disabled = true;
        }

        function resetUI() {
            document.getElementById('pass').value = ""; document.getElementById('pass').disabled = false;
            document.getElementById('btn-val').disabled = false; document.getElementById('gift-area').style.display = 'none';
            document.getElementById('env').style.display = 'inline-block'; document.getElementById('couponCanvas').style.display = 'none';
            document.getElementById('downloadLink').style.display = 'none'; document.getElementById('btn-restart').style.display = 'none';
        }

        function generateTicket() {
            const canvas = document.getElementById('couponCanvas'); const ctx = canvas.getContext('2d');
            const link = document.getElementById('downloadLink'); const restartBtn = document.getElementById('btn-restart');
            const disponibles = VALES.filter(v => !usados.includes(v));
            if (disponibles.length === 0) return;
            const miVale = disponibles[Math.floor(Math.random() * disponibles.length)];
            document.getElementById('env').style.display = 'none';
            canvas.width = 800; canvas.height = 450; canvas.style.display = 'block';
            const hoy = new Date(); const expira = new Date(); expira.setDate(hoy.getDate() + 15);
            ctx.fillStyle = "#ffffff"; ctx.fillRect(0, 0, 800, 450);
            ctx.fillStyle = "#fff0f5";
            for(let i=0; i<15; i++) for(let j=0; j<10; j++) { ctx.font = "20px Arial"; ctx.fillText("‚ô•", i*60 + 20, j*50 + 30); }
            ctx.strokeStyle = "#fb6f92"; ctx.lineWidth = 14; ctx.strokeRect(30, 30, 740, 390); 
            ctx.strokeStyle = "#ffc8dd"; ctx.lineWidth = 4; ctx.strokeRect(45, 45, 710, 360);
            ctx.setLineDash([10, 10]); ctx.strokeStyle = "#ffc8dd"; ctx.beginPath(); ctx.moveTo(60, 240); ctx.lineTo(740, 240); ctx.stroke(); ctx.setLineDash([]);
            ctx.textAlign = "center"; ctx.fillStyle = "#fb6f92"; ctx.font = "bold 48px Quicksand"; ctx.fillText("CUP√ìN V√ÅLIDO POR...", 400, 110);
            ctx.fillStyle = "#8a5a6a"; ctx.font = "bold 34px Quicksand"; ctx.fillText(miVale, 400, 190);
            ctx.font = "bold 20px Quicksand"; ctx.fillStyle = "#ff8fab"; ctx.fillText(`CANJEADO: ${hoy.toLocaleDateString()}`, 400, 290);
            ctx.fillStyle = "#fb6f92"; ctx.fillText(`EXPIRA: ${expira.toLocaleDateString()}`, 400, 335);
            ctx.font = "italic 22px Quicksand"; ctx.fillStyle = "#8a5a6a"; ctx.fillText("De Iv√°n, con mucho amor ‚ù§Ô∏è", 400, 385);
            usados.push(miVale); canjeados.push(codigoActual);
            localStorage.setItem('cuponesUsados', JSON.stringify(usados));
            localStorage.setItem('codigosCanjeados', JSON.stringify(canjeados));
            link.style.display = 'inline-block'; link.href = canvas.toDataURL("image/png");
            link.download = "cupon_zaira.png"; restartBtn.style.display = 'inline-block';
            actualizarEstado();
        }
    </script>
</body>
</html>